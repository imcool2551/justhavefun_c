(this.webpackJsonpredux=this.webpackJsonpredux||[]).push([[0],{116:function(e,t,n){"use strict";n.r(t);var a=n(1),r=n.n(a),o=n(80),l=n.n(o),c=n(9),u=n(84),i=new c.ApolloClient({cache:new c.InMemoryCache,link:Object(u.a)({uri:"https://sangwook.ml/graphql"}),credentials:"include"}),s=n(24),d=n(8),m=(n(95),n(11)),b=n(50),E=n(15),p=function(e){return{type:"todo/LOGIN",payload:{username:e}}},g=function(){return{type:"todo/LOGUT",payload:{}}};function f(e,t){var n=t.payload,a=n.id,r=n.text;switch(t.type){case"todo/LOGIN":return Object(E.a)(Object(E.a)({},e),{},{username:t.payload.username,isLoggedin:!0});case"todo/LOGUT":return Object(E.a)(Object(E.a)({},e),{},{username:"",isLoggedin:!1});case"todo/INIT":return Object(E.a)(Object(E.a)({},e),{},{fetched:!0});case"todo/ADD":var o={id:a,text:r,done:!1};return Object(E.a)(Object(E.a)({},e),{},{todos:[o].concat(Object(b.a)(e.todos))});case"todo/DELETE":return Object(E.a)(Object(E.a)({},e),{},{todos:e.todos.filter((function(e){return e.id!==a}))});case"todo/TOGGLE":return Object(E.a)(Object(E.a)({},e),{},{todos:e.todos.map((function(e){return e.id===a?{id:e.id,text:e.text,done:!e.done}:e}))});case"todo/SEARCH":return Object(E.a)(Object(E.a)({},e),{},{filter:r});default:return e}}var O={username:"",isLoggedin:!1},v=Object(a.createContext)(),j=function(e){var t=e.children,n=Object(a.useReducer)(f,O),o=Object(m.a)(n,2),l=o[0],c=o[1];return r.a.createElement(v.Provider,{value:{isLoggedin:l.isLoggedin,username:l.username,logIn:function(e){return c(p(e))},logOut:function(){return c(g())}}},t)},h=function(){return{type:"counter/INCREMENT"}},y=function(){return{type:"counter/DECREMENT"}},x=function(){return{type:"counter/RESET"}};function T(e,t){switch(t.type){case"counter/INCREMENT":return{number:e.number+1};case"counter/DECREMENT":return{number:e.number-1};case"counter/RESET":return{number:0};default:return e}}var w={number:0},L=Object(a.createContext)(w),N=function(e){var t=e.children,n=Object(a.useReducer)(T,w),o=Object(m.a)(n,2),l=o[0],c=o[1];return r.a.createElement(L.Provider,{value:{number:l.number,increment:function(){c(h())},decrement:function(){c(y())},reset:function(){c(x())}}},t)},C=function(){var e=Object(a.useContext)(v).isLoggedin;return r.a.createElement("nav",null,r.a.createElement(s.b,{to:"/"},"Home")," ",r.a.createElement(s.b,{to:"/todo"},"TODO")," ",r.a.createElement(s.b,{to:"/counter"},"COUNTER")," ",e&&r.a.createElement(s.b,{to:"/logout"}," Logout"))},S=n(31);function k(){var e=Object(S.a)(["\n  query Todos($id: String!) {\n    todos(id: $id) {\n      id\n      text\n      done\n      user {\n        id\n        displayName\n      }\n    }\n  }\n"]);return k=function(){return e},e}function D(){var e=Object(S.a)(["\n  query {\n    allUsers {\n      id\n      displayName\n    }\n  }\n"]);return D=function(){return e},e}function I(){var e=Object(S.a)(["\n  query {\n    myTodos {\n      id\n      text\n      done\n      deleted\n      user {\n        id\n        displayName\n      }\n    }\n  }\n"]);return I=function(){return e},e}function q(){var e=Object(S.a)(["\n  mutation DeleteTodo($id: ID!) {\n    deleteTodo(id: $id) {\n      id\n      text\n      done\n      deleted\n      user {\n        id\n        displayName\n      }\n    }\n  }\n"]);return q=function(){return e},e}function R(){var e=Object(S.a)(["\n  mutation ToggleTodo($id: ID!) {\n    toggleTodo(id: $id) {\n      id\n      text\n      done\n      deleted\n      user {\n        id\n        displayName\n      }\n    }\n  }\n"]);return R=function(){return e},e}function F(){var e=Object(S.a)(["\n  mutation AddTodo($text: String!) {\n    addTodo(text: $text) {\n      id\n      text\n      done\n      deleted\n      user {\n        id\n        displayName\n      }\n    }\n  }\n"]);return F=function(){return e},e}var P=Object(c.gql)(F()),M=Object(c.gql)(R()),$=Object(c.gql)(q()),G=Object(c.gql)(I()),A=Object(c.gql)(D()),U=Object(c.gql)(k()),Q=function(){var e=Object(c.useMutation)(P,{update:function(e,t){var n=t.data.addTodo,a=e.readQuery({query:G}).myTodos;console.log(a,"@@@"),e.writeQuery({query:G,data:{myTodos:[n].concat(Object(b.a)(a))}})}}),t=Object(m.a)(e,2),n=t[0],o=t[1],l=o.data,u=o.loading,i=Object(a.useRef)(null);return r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(e){e.preventDefault(),n({variables:{text:i.current.value}}),i.current.value="",i.current.focus(),console.log(l)}},r.a.createElement("input",{type:"text",placeholder:"Add Todo...",ref:i,disabled:u}),r.a.createElement("button",{disabled:u},"Submit")))},_={textDecoration:"line-through"},H=function(e){var t=e.id,n=e.text,a=e.done,o=Object(c.useMutation)(M),l=Object(m.a)(o,2),u=l[0],i=l[1].loading,s=Object(c.useMutation)($),d=Object(m.a)(s,2),b=d[0],E=d[1].loading;return i||E?r.a.createElement("li",null,"Loading..."):r.a.createElement("li",null,r.a.createElement("span",{style:a?_:null},n),r.a.createElement("input",{type:"checkbox",checked:a,onChange:function(){console.log(typeof t,t),u({variables:{id:t}})}}),r.a.createElement("button",{onClick:function(){console.log(typeof t,t),b({variables:{id:t}})}},"X"))},J=function(){var e=Object(c.useQuery)(G),t=e.loading,n=e.error,o=e.data,l=Object(a.useContext)(v).username;return Object(a.useEffect)((function(){return i.cache.reset(),function(){i.cache.reset()}}),[]),t?"Loading...":n?"Error: ".concat(n.message):r.a.createElement(r.a.Fragment,null,r.a.createElement("h2",null,l,"'s Todo List"),o.myTodos.filter((function(e){return!e.deleted})).map((function(e){return r.a.createElement(H,Object.assign({},e,{key:e.id}))})))},z=function(){var e=Object(a.useState)(""),t=Object(m.a)(e,2),n=t[0],o=t[1],l=Object(c.useQuery)(A,{pollInterval:2e3}),u=l.data,i=l.loading,s=l.error,d=Object(c.useLazyQuery)(U),b=Object(m.a)(d,2),E=b[0],p=b[1].data;return i?"Loading Users...":s?"Error..":r.a.createElement(r.a.Fragment,null,r.a.createElement("select",{onChange:function(e){console.log(e.target.value),o(e.target.value),E({variables:{id:e.target.value}})},value:n},u.allUsers.map((function(e){var t=e.id,n=e.displayName;return r.a.createElement("option",{value:t,key:t},n)}))),r.a.createElement("ul",null,p?p.todos.map((function(e,t){var n=e.id,a=e.text;return e.done?r.a.createElement("li",{key:n,style:{textDecoration:"line-through"}},t+1," \ubc88\uc9f8 : ",a):r.a.createElement("li",{key:n},t+1," \ubc88\uc9f8 : ",a)})):r.a.createElement("li",null,"Loading Todos...")))},B=function(){return Object(a.useContext)(v).isLoggedin?r.a.createElement(r.a.Fragment,null,r.a.createElement(Q,null),r.a.createElement(J,null),r.a.createElement(z,null)):r.a.createElement(d.a,{to:"/"})},V=function(){var e=Object(a.useContext)(L),t=e.number,n=e.increment,o=e.decrement,l=e.reset;return r.a.createElement("div",null,r.a.createElement("h4",null,t),r.a.createElement("button",{onClick:n},"+"),r.a.createElement("button",{onClick:l},"RESET"),r.a.createElement("button",{onClick:o},"-"))},W=n(28),X=n.n(W),K=function(e){var t=Object(a.useState)(e),n=Object(m.a)(t,2),r=n[0],o=n[1];return{value:r,onChange:function(e){o(e.target.value)}}},Y=function(){var e=K(""),t=K(""),n=K(""),o=K(""),l=Object(a.useState)(""),c=Object(m.a)(l,2),u=c[0],i=c[1],s=Object(a.useContext)(v),b=s.isLoggedin,E=s.logIn,p=s.logOut;Object(a.useEffect)((function(){X()("/auth/login_check").then((function(e){var t=e.data;t.isLoggedin?E(t.displayName):p()}))}),[]);return r.a.createElement(r.a.Fragment,null,b&&r.a.createElement(d.a,{to:{pathname:"/"}}),r.a.createElement("h3",null,u),r.a.createElement("form",{onSubmit:function(a){a.preventDefault(),t.value===n.value?X.a.post("/auth/signup",{email:e.value,password:t.value,displayName:o.value}).then((function(e){var t=e.data;console.log(t),t.success&&E(t.displayName)})).catch((function(e){console.log(e.response);var t=e.response.data.error_msg;i(t[0])})):i("Password does not match!")}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",Object.assign({type:"email",name:"email",placeholder:"Email..."},e))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",Object.assign({type:"password",name:"password",placeholder:"Password..."},t))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password2"},"Password:"),r.a.createElement("input",Object.assign({type:"password",name:"password2",placeholder:"Validate Password..."},n))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Display Name:"),r.a.createElement("input",Object.assign({type:"text",name:"displayName",placeholder:"DisplayName..."},o))),r.a.createElement("div",null,r.a.createElement("button",null,"Sign up"))))},Z=function(){var e=K(""),t=K(""),n=Object(a.useState)(""),o=Object(m.a)(n,2),l=o[0],c=o[1],u=Object(a.useContext)(v),i=u.isLoggedin,d=u.username,b=u.logIn,E=u.logOut;Object(a.useEffect)((function(){X()("/auth/login_check").then((function(e){var t=e.data;t.isLoggedin?b(t.displayName):E()}))}),[]);return i?r.a.createElement("h1",null,"Welcome, ",d):r.a.createElement(r.a.Fragment,null,r.a.createElement("h3",null,l),r.a.createElement("form",{onSubmit:function(n){n.preventDefault(),X.a.post("/auth/login",{email:e.value,password:t.value}).then((function(e){var t=e.data;console.log(t);var n=t.success,a=t.displayName;n&&b(a)})).catch((function(e){console.log(e.response);var t=e.response.data.error_msg;c(t[0])}))}},r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"email"},"Email:"),r.a.createElement("input",Object.assign({type:"email",name:"email",placeholder:"Email..."},e))),r.a.createElement("div",null,r.a.createElement("label",{htmlFor:"password"},"Password:"),r.a.createElement("input",Object.assign({type:"password",name:"password",placeholder:"Password..."},t))),r.a.createElement("div",null,r.a.createElement("button",null,"Log In"))),r.a.createElement("div",null,r.a.createElement("a",{href:"http://localhost:5000/auth/google"},"Google Login")),r.a.createElement("div",null,r.a.createElement(s.b,{to:"/signup"},"Signup")))},ee=function(e){var t=e.history,n=Object(a.useContext)(v).logOut;return Object(a.useEffect)((function(){X.a.post("/auth/logout").then((function(e){console.log(e),n(),t.replace("/")})).catch((function(e){console.log(e.response)})).then((function(){t.replace("/")}))}),[]),r.a.createElement("div",null)},te=function(){return r.a.createElement(j,null,r.a.createElement(N,null,r.a.createElement(s.a,{basename:"/justhavefun_c"},r.a.createElement(C,null),r.a.createElement(d.d,null,r.a.createElement(d.b,{exact:!0,path:"/",component:Z}),r.a.createElement(d.b,{path:"/signup",component:Y}),r.a.createElement(d.b,{path:"/logout",component:ee}),r.a.createElement(d.b,{path:"/todo",component:B}),r.a.createElement(d.b,{path:"/counter",component:V})))))};l.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(c.ApolloProvider,{client:i},r.a.createElement(te,null))),document.getElementById("root"))},85:function(e,t,n){e.exports=n(116)},95:function(e,t,n){}},[[85,1,2]]]);
//# sourceMappingURL=main.2adfbdc0.chunk.js.map